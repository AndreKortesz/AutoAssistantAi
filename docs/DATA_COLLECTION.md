# Data Collection — Сбор болячек

## Обзор процесса

```
Источники данных → Deep Research → Gold Standard JSON → Валидация → База
```

---

## Источники информации

### Первичные (высокий приоритет)

| Источник | Описание | Доверие |
|----------|----------|---------|
| **Drive2.ru** | Опыт владельцев, подробные отчёты | ⭐⭐⭐⭐⭐ |
| **Профильные форумы** | Клубы по маркам (e.g. bmwclub.ru) | ⭐⭐⭐⭐ |
| **TSB (Technical Service Bulletins)** | Официальные бюллетени производителей | ⭐⭐⭐⭐⭐ |
| **NHTSA / Recall databases** | Отзывные кампании | ⭐⭐⭐⭐⭐ |

### Вторичные

| Источник | Описание | Доверие |
|----------|----------|---------|
| YouTube (технические каналы) | Видео-разборы проблем | ⭐⭐⭐ |
| Автосервисы (статьи) | Экспертные мнения | ⭐⭐⭐ |
| Reddit / автофорумы | Обсуждения владельцев | ⭐⭐⭐ |

### Избегать

- SEO-статьи без конкретики
- Агрегаторы без источников
- Устаревшая информация (>5 лет)

---

## Промпт для Deep Research

### Базовый шаблон

```
Найди подтверждённые массовые проблемы (болячки) автомобиля:
[Марка] [Модель] [Поколение] ([годы выпуска])

Для КАЖДОЙ проблемы укажи:

1. НАЗВАНИЕ проблемы (коротко)
2. СИСТЕМА: двигатель / трансмиссия / подвеска / тормоза / кузов / электрика
3. КРИТИЧНОСТЬ: critical / high / medium / low
4. СИМПТОМЫ: что видит/слышит владелец + при каких условиях
5. ПРИЧИНА: почему происходит + что НЕ является причиной
6. ПРОБЕГ: на каком km обычно появляется (диапазон)
7. ЧАСТОТА: у какого % владельцев встречается
8. РЕШЕНИЕ: 
   - Для сервиса: что делают, сколько стоит работа
   - Для DIY: возможно ли, сложность 1-5, время, инструменты
9. ЗАПЧАСТИ:
   - Артикул (part number)
   - Ревизии (если есть старая/новая)
   - Цена в РФ и США
   - Где купить
10. КОДЫ OBD: если есть
11. СВЯЗАННЫЕ ПРОБЛЕМЫ: что ломается вместе
12. ОТЗЫВНЫЕ / ИСКИ: если были
13. ИСТОЧНИКИ: ссылки на Drive2, форумы, TSB

Фокусируйся на:
- Подтверждённых проблемах (много отчётов)
- Конструктивных дефектах
- Типичном износе раньше срока
- Проблемах с конкретными ревизиями запчастей

НЕ включай:
- Разовые поломки
- Проблемы из-за ДТП
- Проблемы из-за некачественного обслуживания
```

### Пример для конкретного авто

```
Найди подтверждённые массовые проблемы автомобиля:
Audi A1 I (8X) (2010-2015)

Двигатели:
- 1.2 TFSI (CBZA, CBZB) 86-105 л.с.
- 1.4 TFSI (CAXA, CAXC) 122-185 л.с.
- 1.6 TDI (CAYB, CAYC) 90-105 л.с.

Коробки:
- 5-МКПП
- 7-DSG (DQ200)
- S-tronic

[Далее шаблон выше]
```

---

## Пример собранных данных

### Ford Mustang 6G EcoBoost — 26 болячек

| # | Проблема | Система | Severity | Пробег |
|---|----------|---------|----------|--------|
| 1 | Датчик давления топлива | Топливная | Critical | 0-∞ |
| 2 | Маслоотделитель картерных газов | Двигатель | Critical | 30-80k |
| 3 | Шкив демпфера коленвала | Двигатель | High | 50-100k |
| 4 | Растяжение цепи ГРМ | Двигатель | Critical | 100-150k |
| 5 | Версия прошивки PCM | Электрика | High | 0-∞ |
| ... | ... | ... | ... | ... |

### Audi A1 I (8X) — 63 болячки

| # | Проблема | Система | Severity | Пробег |
|---|----------|---------|----------|--------|
| 1 | Растяжение цепи ГРМ | Двигатель 1.2/1.4 | Critical | 30-80k |
| 2 | Трещина гидроплиты мехатроника DSG | Трансмиссия | Critical | 80-150k |
| 3 | Повышенный расход масла | Двигатель 1.4 | High | 50-100k |
| ... | ... | ... | ... | ... |

---

## Pipeline автоматизации

### Этап 1: Подготовка списка

```
generations_full.xlsx
├── Toyota Camry XV70 (2017-2024)
├── Kia Rio IV (2017-2023)
├── Hyundai Solaris II (2017-2023)
└── ... (518 поколений)
```

### Этап 2: Deep Research

Для каждого поколения:
1. Сформировать промпт с конкретными двигателями/КПП
2. Запустить Deep Research
3. Получить структурированный ответ
4. Сохранить в промежуточный файл

### Этап 3: Конвертация в JSON

```python
def convert_to_gold_standard(research_result):
    """
    Конвертирует результат Deep Research в Gold Standard JSON
    """
    issues = []
    for problem in research_result['problems']:
        issue = {
            'id': generate_id(problem),
            'car': extract_car_info(research_result),
            'issue': {
                'title': problem['name'],
                'system': problem['system'],
                'severity': problem['severity'],
                'symptoms': problem['symptoms'],
                'cause': problem['cause'],
                # ...
            },
            'mileage': problem['mileage'],
            'solutions': problem['solutions'],
            'parts': problem['parts'],
            # ...
        }
        issues.append(issue)
    return issues
```

### Этап 4: Валидация

- [ ] Все обязательные поля заполнены
- [ ] Артикулы валидны (формат)
- [ ] Пробеги логичны (start < end)
- [ ] Severity соответствует описанию
- [ ] Нет дубликатов

### Этап 5: Загрузка в базу

```
issues/
├── toyota/
│   ├── camry/
│   │   ├── xv70_timing_chain.json
│   │   ├── xv70_strut_mount.json
│   │   └── ...
│   └── ...
└── ...
```

---

## Оценка времени

### Ручной сбор (без автоматизации)
- 1 поколение = 2-4 часа
- 518 поколений = 1,000-2,000 часов = 6-12 месяцев

### С Deep Research + автоматизация
- 1 поколение = 15-30 минут
- 518 поколений = 130-260 часов = 5-7 рабочих дней

### Приоритизация

**Фаза 1: Топ-10 моделей (50 поколений)**
- Toyota Camry, RAV4, Corolla
- Kia Rio, Ceed, Sportage
- Hyundai Solaris, Tucson, Creta
- VW Polo, Tiguan

**Фаза 2: Топ-30 моделей (+100 поколений)**

**Фаза 3: Остальные популярные (+300 поколений)**

---

## Инструменты

### autoru_parser.py

Парсер справочника Auto.ru для получения структуры:
```
Марка → Модель → Поколение → Двигатель → КПП
```

### Deep Research (Claude)

Для сбора информации о болячках по промпту.

### Скрипт валидации

```python
def validate_issue(issue):
    errors = []
    
    # Проверка обязательных полей
    required = ['id', 'car', 'issue', 'mileage', 'solutions']
    for field in required:
        if field not in issue:
            errors.append(f"Missing required field: {field}")
    
    # Проверка логики пробега
    if issue['mileage']['typical_start_km'] > issue['mileage']['typical_end_km']:
        errors.append("Mileage start > end")
    
    # Проверка severity
    valid_severities = ['critical', 'high', 'medium', 'low']
    if issue['issue']['severity'] not in valid_severities:
        errors.append(f"Invalid severity: {issue['issue']['severity']}")
    
    return errors
```

---

## Качество данных

### Gold Standard критерии

| Критерий | Требование |
|----------|------------|
| Полнота | ≥ 90% полей заполнено |
| Источники | ≥ 2 независимых источника |
| Актуальность | Данные не старше 3 лет |
| Проверка | Валидация пройдена |

### Уровни качества

| Уровень | Описание |
|---------|----------|
| `gold` | Эталон, всё заполнено и проверено |
| `verified` | Проверено, но не все поля |
| `unverified` | Собрано, но не проверено |
| `draft` | Черновик, требует доработки |

---

## Обновление данных

### Триггеры для обновления

- Новая отзывная кампания
- Результат коллективного иска
- Выход новой ревизии запчасти
- Изменение цен (>20%)
- Новые массовые отчёты на форумах

### Периодичность

- Отзывные кампании: еженедельно
- Цены на запчасти: ежемесячно
- Новые болячки: при появлении массовых отчётов

---

*Data Collection Guide v1.0 — январь 2026*
